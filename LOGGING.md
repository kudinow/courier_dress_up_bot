# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ —Å –ª–æ–≥–∞–º–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç (—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ —Ñ–∞–π–ª)
```bash
./run.sh
```
–õ–æ–≥–∏ –±—É–¥—É—Ç –≤—ã–≤–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ `bot.log`

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ù–∞–ø—Ä—è–º—É—é
```bash
python3 -m bot.main
```

## –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤

### –ú–∞—Ä–∫–µ—Ä—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

- `üöÄ [GENERATION]` - –ù–∞—á–∞–ª–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–æ—Ç–æ
- `‚úÖ [GENERATION] COMPLETE` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (–æ–±—â–µ–µ –≤—Ä–µ–º—è)
- `üîÑ [REGENERATE]` - –ù–∞—á–∞–ª–æ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- `‚úÖ [REGENERATE] COMPLETE` - –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- `‚è±Ô∏è  [GPT]` - –ù–∞—á–∞–ª–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–∞ —á–µ—Ä–µ–∑ GPT
- `‚úÖ [GPT]` - –ü—Ä–æ–º–ø—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
- `‚è±Ô∏è  [KIE]` - –û–ø–µ—Ä–∞—Ü–∏–∏ —Å kie.ai
- `‚úÖ [KIE]` - –û–ø–µ—Ä–∞—Ü–∏—è kie.ai –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- `üîÑ [KIE]` - Polling —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏

### –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

```
üöÄ [GENERATION] Starting for user 123456: type=walking, scene=delivery
‚è±Ô∏è  [GPT] Generating courier prompt, attempt 1/3
‚úÖ [GPT] Generated prompt in 2.34s: Professional portrait photograph...
‚è±Ô∏è  [KIE] Creating task...
‚úÖ [KIE] Task created: task_abc123 in 0.45s
‚è±Ô∏è  [KIE] Waiting for task task_abc123...
üîÑ [KIE] Poll #1: state=pending, elapsed=0s
üîÑ [KIE] Poll #2: state=processing, elapsed=3s
üîÑ [KIE] Poll #3: state=processing, elapsed=6s
üîÑ [KIE] Poll #4: state=success, elapsed=9s
‚úÖ [KIE] Task completed in 9.12s (4 polls)
‚è±Ô∏è  [KIE] Downloading result image...
‚úÖ [KIE] Downloaded 245.3KB in 0.78s
‚úÖ [GENERATION] COMPLETE for user 123456 in 12.69s
```

## –£–∑–∫–∏–µ –º–µ—Å—Ç–∞ –∏ –∏—Ö –∞–Ω–∞–ª–∏–∑

### 1. GPT Prompt Generation (–æ–±—ã—á–Ω–æ 1-3 —Å–µ–∫—É–Ω–¥—ã)
- **–ù–æ—Ä–º–∞–ª—å–Ω–æ**: 1-3s
- **–î–æ–ª–≥–æ**: >5s
- **–ü—Ä–∏—á–∏–Ω—ã**: –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ OpenRouter API, —Å–µ—Ç–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏

### 2. KIE Task Creation (–æ–±—ã—á–Ω–æ <1 —Å–µ–∫—É–Ω–¥—ã)
- **–ù–æ—Ä–º–∞–ª—å–Ω–æ**: 0.3-0.8s
- **–î–æ–ª–≥–æ**: >2s
- **–ü—Ä–∏—á–∏–Ω—ã**: —Å–µ—Ç–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ API

### 3. KIE Task Processing (–æ—Å–Ω–æ–≤–Ω–æ–µ –≤—Ä–µ–º—è, 30-90 —Å–µ–∫—É–Ω–¥)
- **–ù–æ—Ä–º–∞–ª—å–Ω–æ**: 30-60s
- **–î–æ–ª–≥–æ**: >90s
- **–û—á–µ–Ω—å –¥–æ–ª–≥–æ**: >120s (–º–æ–∂–µ—Ç —Ç–∞–π–º–∞—É—Ç —á–µ—Ä–µ–∑ 300s)
- **–ü—Ä–∏—á–∏–Ω—ã**: —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–º–ø—Ç–∞, –æ—á–µ—Ä–µ–¥—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### 4. Image Download (–æ–±—ã—á–Ω–æ <2 —Å–µ–∫—É–Ω–¥)
- **–ù–æ—Ä–º–∞–ª—å–Ω–æ**: 0.5-1.5s –¥–ª—è 200-500KB
- **–î–æ–ª–≥–æ**: >3s
- **–ü—Ä–∏—á–∏–Ω—ã**: —Å–µ—Ç–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏, –±–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### 5. –û–±—â–µ–µ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- **–ù–æ—Ä–º–∞–ª—å–Ω–æ**: 35-70s
- **–ü—Ä–∏–µ–º–ª–µ–º–æ**: 70-100s
- **–î–æ–ª–≥–æ**: >100s

## –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü–æ–∏—Å–∫ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
```bash
# –í—Å–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
grep "GENERATION] COMPLETE" bot.log | sort -k12 -rn

# –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª—å—à–µ 100 —Å–µ–∫—É–Ω–¥
grep "GENERATION] COMPLETE" bot.log | awk '{if ($12 > 100) print}'
```

### –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫
```bash
# –í—Å–µ –æ—à–∏–±–∫–∏
grep -E "ERROR|‚ùå" bot.log

# –û—à–∏–±–∫–∏ –ø–æ —Ç–∏–ø—É
grep "OpenAI error" bot.log
grep "KieClient error" bot.log
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ polling
```bash
# –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ polls –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
grep "polls)" bot.log | awk '{sum+=$10; count++} END {print "Average polls:", sum/count}'
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ï—Å–ª–∏ GPT –º–µ–¥–ª–µ–Ω–Ω—ã–π**:
   - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é –º–æ–¥–µ–ª—å

2. **–ï—Å–ª–∏ KIE –¥–æ–ª–≥–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç**:
   - –£–ø—Ä–æ—Å—Ç–∏—Ç—å –ø—Ä–æ–º–ø—Ç
   - –£–≤–µ–ª–∏—á–∏—Ç—å poll_interval (–º–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤)
   - –°–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π kie.ai

3. **–ï—Å–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ–¥–ª–µ–Ω–Ω–∞—è**:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
   - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç (jpeg vs png)
